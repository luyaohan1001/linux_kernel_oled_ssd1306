<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SSD1306_OLED_Device_Driver: driver.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SSD1306_OLED_Device_Driver
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">driver.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file implements the necessary i2c_client probe and remove callbacks on the SSD1306 I2C bus device driver. On top of <a class="el" href="driver_8c.html" title="This file implements the necessary i2c_client probe and remove callbacks on the SSD1306 I2C bus devic...">driver.c</a>, display configurations and initialization are implemented in <a class="el" href="datalink_8c.html" title="Datalink layer implementation for SSD1306 OLED Driver, I2C-based operations. ">datalink.c</a>. On top of datalink, OLED printing / graphics are implemented in <a class="el" href="graphics_8c.html" title="ssd1306 OLED graphics display APIs implementation. ">graphics.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="datalink_8h_source.html">datalink.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="graphics_8h_source.html">graphics.h</a>&quot;</code><br />
<code>#include &quot;oled_sysfs.h&quot;</code><br />
<code>#include &lt;linux/delay.h&gt;</code><br />
<code>#include &lt;linux/i2c.h&gt;</code><br />
<code>#include &lt;linux/module.h&gt;</code><br />
<code>#include &lt;linux/sysfs.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for driver.c:</div>
<div class="dyncontent">
<div class="center"><img src="driver_8c__incl.png" border="0" usemap="#driver_8c" alt=""/></div>
<!-- MAP 0 -->
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad94b36675e7eb067ea3ce6ff9e244a44"><td class="memItemLeft" align="right" valign="top"><a id="ad94b36675e7eb067ea3ce6ff9e244a44"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MODULE_LICENSE</b> (&quot;GPL&quot;)</td></tr>
<tr class="separator:ad94b36675e7eb067ea3ce6ff9e244a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594adc15634a4e56dcb80198b964a227"><td class="memItemLeft" align="right" valign="top"><a id="a594adc15634a4e56dcb80198b964a227"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MODULE_AUTHOR</b> (&quot;Luyao Han&quot;)</td></tr>
<tr class="separator:a594adc15634a4e56dcb80198b964a227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae15b5df66e4e05b36899a90a8a9ff55d"><td class="memItemLeft" align="right" valign="top"><a id="ae15b5df66e4e05b36899a90a8a9ff55d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MODULE_DESCRIPTION</b> (&quot;Linux kernel module driver for ssd1306 oled display&quot;)</td></tr>
<tr class="separator:ae15b5df66e4e05b36899a90a8a9ff55d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2ce7e7fa1f20b7193e04c34583885a2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driver_8c.html#ac2ce7e7fa1f20b7193e04c34583885a2">driver_on_probe</a> (struct <a class="el" href="driver_8c.html#a77ca3c5047325f153b5679bce4576b39">i2c_client</a> *client, const struct i2c_device_id *device_id)</td></tr>
<tr class="memdesc:ac2ce7e7fa1f20b7193e04c34583885a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function pointer called on probing (driver-device binding) of the device driver. This function implements the following prototype defined struct i2c_driver in linux/i2c.h: int (*probe)(struct i2c_client *client, const struct i2c_device_id *id);.  <a href="#ac2ce7e7fa1f20b7193e04c34583885a2">More...</a><br /></td></tr>
<tr class="separator:ac2ce7e7fa1f20b7193e04c34583885a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e690de4cdba34c6389cf7bdc76e13fa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driver_8c.html#a1e690de4cdba34c6389cf7bdc76e13fa">driver_on_remove</a> (struct <a class="el" href="driver_8c.html#a77ca3c5047325f153b5679bce4576b39">i2c_client</a> *client)</td></tr>
<tr class="memdesc:a1e690de4cdba34c6389cf7bdc76e13fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function pointe called on the removal of the device driver. This function implements the following prototype defined struct i2c_driver in linux/i2c.h: void (*remove)(struct i2c_client *client);.  <a href="#a1e690de4cdba34c6389cf7bdc76e13fa">More...</a><br /></td></tr>
<tr class="separator:a1e690de4cdba34c6389cf7bdc76e13fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b2b1f66cb85cfa5ba687405cfea6be7"><td class="memItemLeft" align="right" valign="top"><a id="a0b2b1f66cb85cfa5ba687405cfea6be7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driver_8c.html#a0b2b1f66cb85cfa5ba687405cfea6be7">MODULE_DEVICE_TABLE</a> (of, <a class="el" href="driver_8c.html#ade8e0b3b58db81e759d44841b22828f4">driver_id</a>)</td></tr>
<tr class="memdesc:a0b2b1f66cb85cfa5ba687405cfea6be7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This macro describes which devices each specific driver can support. At compilation time, the build process extracts this information out of the driver and builds a table. <br /></td></tr>
<tr class="separator:a0b2b1f66cb85cfa5ba687405cfea6be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8039b804ca38fe27ebaba76416a5dd53"><td class="memItemLeft" align="right" valign="top"><a id="a8039b804ca38fe27ebaba76416a5dd53"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MODULE_DEVICE_TABLE</b> (i2c, <a class="el" href="driver_8c.html#a43765295ecc04729376fab5e4e243172">driver_device_id</a>)</td></tr>
<tr class="separator:a8039b804ca38fe27ebaba76416a5dd53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2507bec7b1d573cca5bf5f670b2254"><td class="memItemLeft" align="right" valign="top"><a id="a5a2507bec7b1d573cca5bf5f670b2254"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>module_i2c_driver</b> (i2c_driver)</td></tr>
<tr class="separator:a5a2507bec7b1d573cca5bf5f670b2254"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a77ca3c5047325f153b5679bce4576b39"><td class="memItemLeft" align="right" valign="top">struct i2c_client *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driver_8c.html#a77ca3c5047325f153b5679bce4576b39">i2c_client</a></td></tr>
<tr class="memdesc:a77ca3c5047325f153b5679bce4576b39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifies the device (i.e. SSD1306 OLED contoller) connected to the i2c bus.  <a href="#a77ca3c5047325f153b5679bce4576b39">More...</a><br /></td></tr>
<tr class="separator:a77ca3c5047325f153b5679bce4576b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade8e0b3b58db81e759d44841b22828f4"><td class="memItemLeft" align="right" valign="top">static struct of_device_id&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driver_8c.html#ade8e0b3b58db81e759d44841b22828f4">driver_id</a> []</td></tr>
<tr class="memdesc:ade8e0b3b58db81e759d44841b22828f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifies the ".compatible" strings. of_device_id array should store the same value as corresponding node's "compatible" field in the device tree. In this case the oled.dts in the same directory has the "compatible" field. When the .compatible field here matches the device tree, the I2C device will be probed.  <a href="#ade8e0b3b58db81e759d44841b22828f4">More...</a><br /></td></tr>
<tr class="separator:ade8e0b3b58db81e759d44841b22828f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43765295ecc04729376fab5e4e243172"><td class="memItemLeft" align="right" valign="top">static struct i2c_device_id&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driver_8c.html#a43765295ecc04729376fab5e4e243172">driver_device_id</a> []</td></tr>
<tr class="memdesc:a43765295ecc04729376fab5e4e243172"><td class="mdescLeft">&#160;</td><td class="mdescRight">This array is pointed by the id_table field of struct i2c_driver. The id_table is used for non-DT based probing of I2C-devices.  <a href="#a43765295ecc04729376fab5e4e243172">More...</a><br /></td></tr>
<tr class="separator:a43765295ecc04729376fab5e4e243172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407109b15209241099d7a1b7c3ae0ae0"><td class="memItemLeft" align="right" valign="top">static struct i2c_driver&#160;</td><td class="memItemRight" valign="bottom"><b>i2c_driver</b></td></tr>
<tr class="separator:a407109b15209241099d7a1b7c3ae0ae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file implements the necessary i2c_client probe and remove callbacks on the SSD1306 I2C bus device driver. On top of <a class="el" href="driver_8c.html" title="This file implements the necessary i2c_client probe and remove callbacks on the SSD1306 I2C bus devic...">driver.c</a>, display configurations and initialization are implemented in <a class="el" href="datalink_8c.html" title="Datalink layer implementation for SSD1306 OLED Driver, I2C-based operations. ">datalink.c</a>. On top of datalink, OLED printing / graphics are implemented in <a class="el" href="graphics_8c.html" title="ssd1306 OLED graphics display APIs implementation. ">graphics.c</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Luyao Han (<a href="#" onclick="location.href='mai'+'lto:'+'luy'+'ao'+'han'+'10'+'01@'+'gm'+'ail'+'.c'+'om'; return false;">luyao<span style="display: none;">.nosp@m.</span>han1<span style="display: none;">.nosp@m.</span>001@g<span style="display: none;">.nosp@m.</span>mail<span style="display: none;">.nosp@m.</span>.com</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>12-21-2022 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac2ce7e7fa1f20b7193e04c34583885a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2ce7e7fa1f20b7193e04c34583885a2">&#9670;&nbsp;</a></span>driver_on_probe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int driver_on_probe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="driver_8c.html#a77ca3c5047325f153b5679bce4576b39">i2c_client</a> *&#160;</td>
          <td class="paramname"><em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct i2c_device_id *&#160;</td>
          <td class="paramname"><em>device_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function pointer called on probing (driver-device binding) of the device driver. This function implements the following prototype defined struct i2c_driver in linux/i2c.h: int (*probe)(struct i2c_client *client, const struct i2c_device_id *id);. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">client</td><td>Pointer to the i2c_client instance. </td></tr>
    <tr><td class="paramname">device_id</td><td>The device id to be probed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error status. </dd></dl>

</div>
</div>
<a id="a1e690de4cdba34c6389cf7bdc76e13fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e690de4cdba34c6389cf7bdc76e13fa">&#9670;&nbsp;</a></span>driver_on_remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int driver_on_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="driver_8c.html#a77ca3c5047325f153b5679bce4576b39">i2c_client</a> *&#160;</td>
          <td class="paramname"><em>client</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function pointe called on the removal of the device driver. This function implements the following prototype defined struct i2c_driver in linux/i2c.h: void (*remove)(struct i2c_client *client);. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">client</td><td>Pointer to the i2c_client instance. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a43765295ecc04729376fab5e4e243172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43765295ecc04729376fab5e4e243172">&#9670;&nbsp;</a></span>driver_device_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct i2c_device_id driver_device_id[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {{<span class="stringliteral">&quot;oled_device&quot;</span>, 0},</div><div class="line">                                                  {}}</div></div><!-- fragment -->
<p>This array is pointed by the id_table field of struct i2c_driver. The id_table is used for non-DT based probing of I2C-devices. </p>

</div>
</div>
<a id="ade8e0b3b58db81e759d44841b22828f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade8e0b3b58db81e759d44841b22828f4">&#9670;&nbsp;</a></span>driver_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct of_device_id driver_id[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">    {.compatible = <span class="stringliteral">&quot;ssd1306, oled_device&quot;</span>}, {}}</div></div><!-- fragment -->
<p>Specifies the ".compatible" strings. of_device_id array should store the same value as corresponding node's "compatible" field in the device tree. In this case the oled.dts in the same directory has the "compatible" field. When the .compatible field here matches the device tree, the I2C device will be probed. </p>

</div>
</div>
<a id="a77ca3c5047325f153b5679bce4576b39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77ca3c5047325f153b5679bce4576b39">&#9670;&nbsp;</a></span>i2c_client</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct i2c_client* i2c_client</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifies the device (i.e. SSD1306 OLED contoller) connected to the i2c bus. </p>
<p>Pointer to the i2c_client instance. </p>

</div>
</div>
<a id="a407109b15209241099d7a1b7c3ae0ae0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a407109b15209241099d7a1b7c3ae0ae0">&#9670;&nbsp;</a></span>i2c_driver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct i2c_driver i2c_driver</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">    </div><div class="line">    .probe = <a class="code" href="driver_8c.html#ac2ce7e7fa1f20b7193e04c34583885a2">driver_on_probe</a>,</div><div class="line">    .remove = <a class="code" href="driver_8c.html#a1e690de4cdba34c6389cf7bdc76e13fa">driver_on_remove</a>,</div><div class="line">    .id_table = <a class="code" href="driver_8c.html#a43765295ecc04729376fab5e4e243172">driver_device_id</a>,</div><div class="line">    .driver =</div><div class="line">        {</div><div class="line">            .name = <span class="stringliteral">&quot;oled_device&quot;</span>,</div><div class="line">            .of_match_table = <a class="code" href="driver_8c.html#ade8e0b3b58db81e759d44841b22828f4">driver_id</a>,</div><div class="line">        },</div><div class="line">}</div><div class="ttc" id="driver_8c_html_a1e690de4cdba34c6389cf7bdc76e13fa"><div class="ttname"><a href="driver_8c.html#a1e690de4cdba34c6389cf7bdc76e13fa">driver_on_remove</a></div><div class="ttdeci">static int driver_on_remove(struct i2c_client *client)</div><div class="ttdoc">Callback function pointe called on the removal of the device driver. This function implements the fol...</div><div class="ttdef"><b>Definition:</b> driver.c:130</div></div>
<div class="ttc" id="driver_8c_html_ade8e0b3b58db81e759d44841b22828f4"><div class="ttname"><a href="driver_8c.html#ade8e0b3b58db81e759d44841b22828f4">driver_id</a></div><div class="ttdeci">static struct of_device_id driver_id[]</div><div class="ttdoc">Specifies the &quot;.compatible&quot; strings. of_device_id array should store the same value as corresponding ...</div><div class="ttdef"><b>Definition:</b> driver.c:43</div></div>
<div class="ttc" id="driver_8c_html_ac2ce7e7fa1f20b7193e04c34583885a2"><div class="ttname"><a href="driver_8c.html#ac2ce7e7fa1f20b7193e04c34583885a2">driver_on_probe</a></div><div class="ttdeci">static int driver_on_probe(struct i2c_client *client, const struct i2c_device_id *id)</div><div class="ttdoc">Callback function pointer called on probing (driver-device binding) of the device driver...</div><div class="ttdef"><b>Definition:</b> driver.c:85</div></div>
<div class="ttc" id="driver_8c_html_a43765295ecc04729376fab5e4e243172"><div class="ttname"><a href="driver_8c.html#a43765295ecc04729376fab5e4e243172">driver_device_id</a></div><div class="ttdeci">static struct i2c_device_id driver_device_id[]</div><div class="ttdoc">This array is pointed by the id_table field of struct i2c_driver. The id_table is used for non-DT bas...</div><div class="ttdef"><b>Definition:</b> driver.c:58</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
